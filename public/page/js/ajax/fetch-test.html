<!DOCTYPE html>
<html lang="ko">
<head>
<title>Fetch</title>
<meta charset="utf-8">
<link rel="icon" type="image/png" href="/image/favicon.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/css/normalize.css" />
<link rel="stylesheet" href="/css/letters.css" />
<link rel="stylesheet" href="/css/style.css"/>
<script src="/lib/jquery-1.12.4.js"></script>
</head>
<body>
<div class="align-center">
  <h1>Fetch</h1>
  <p></p>
  <button type="button" onclick="fn1()">안눌러도됨</button>
  <button type="button" onclick="fn2()">안눌러도됨2</button>
  <div class="result">
    <h4>first-then</h4><p id="first-then"></p>
  </div>
  <div class="result">
    <h4>second-then</h4><p id="second-then"></p>
  </div>
</div>
<script>
function fn1() {
  let params = {
    foo: 'bar',
    numeric: 1234567890
  };
  let init = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json; charset=UTF-8',
    },
    body: JSON.stringify(params)
  };
  fetch('/get-my-request-body.data', init).then(resp => {
    console.log('first then:', resp);
    return resp.text();
  }).then(text => {
    document.querySelector('#first-then').innerHTML = text;
  })
}

async function fn2() {
  let params = {
    user: 'waldo'
  };
  let init = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json; charset=UTF-8',
    },
    body: JSON.stringify(params)
  };
  let response = await fetch('/get-my-request-body.data', init);
  let json = await response.json();
  document.querySelector('#second-then').innerHTML = JSON.stringify(json);
}

fn1();
fn2();
</script>
</body>
</html>
